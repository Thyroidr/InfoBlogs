<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/InfoBlogs/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/InfoBlogs/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/InfoBlogs/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/InfoBlogs/images/logo.svg" color="#222">

<link rel="stylesheet" href="/InfoBlogs/css/main.css">


<link rel="stylesheet" href="/InfoBlogs/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"thyroidr.github.io","root":"/InfoBlogs/","scheme":"Mist","version":"7.8.0","exturl":false,"sidebar":{"position":"left","Muse | Mist":280,"display":"always","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="DTOJ 1103: PaintGiven a piece of paper of size $n \times m$, you have a pen that can draw $p$ different lines, line $i$ can draw from $(x, y)$ to $(x+a_i, y+b_i)$. We want start drawing from $(0, 0)$">
<meta property="og:type" content="article">
<meta property="og:title" content="DP Practice">
<meta property="og:url" content="https://thyroidr.github.io/InfoBlogs/uncategorized/DP/dp-practice/">
<meta property="og:site_name" content="InfoBlogs">
<meta property="og:description" content="DTOJ 1103: PaintGiven a piece of paper of size $n \times m$, you have a pen that can draw $p$ different lines, line $i$ can draw from $(x, y)$ to $(x+a_i, y+b_i)$. We want start drawing from $(0, 0)$">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2018-10-27T00:15:54.000Z">
<meta property="article:modified_time" content="2019-04-17T01:38:56.000Z">
<meta property="article:author" content="Ryan Wang">
<meta property="article:tag" content="dp">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://thyroidr.github.io/InfoBlogs/uncategorized/DP/dp-practice/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>DP Practice | InfoBlogs</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/InfoBlogs/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">InfoBlogs</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">by Ryan Wang</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/InfoBlogs/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/InfoBlogs/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/InfoBlogs/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/InfoBlogs/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

  <a href="https://github.com/thyroidr" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://thyroidr.github.io/InfoBlogs/uncategorized/DP/dp-practice/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/InfoBlogs/images/avatar.png">
      <meta itemprop="name" content="Ryan Wang">
      <meta itemprop="description" content="Museum of my involvement in Informatics Olympiads & competitive programming">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="InfoBlogs">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          DP Practice
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-10-27 11:15:54" itemprop="dateCreated datePublished" datetime="2018-10-27T11:15:54+11:00">2018-10-27</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2019-04-17 11:38:56" itemprop="dateModified" datetime="2019-04-17T11:38:56+10:00">2019-04-17</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h2 id="DTOJ-1103-Paint"><a href="#DTOJ-1103-Paint" class="headerlink" title="DTOJ 1103: Paint"></a>DTOJ 1103: Paint</h2><p>Given a piece of paper of size $n \times m$, you have a pen that can draw $p$ different lines, line $i$ can draw from $(x, y)$ to $(x+a_i, y+b_i)$. We want start drawing from $(0, 0)$ and finish at $(n, 0)$. Find the number of fundamentally different paintings we could draw (meaning that we consider drawing the line $(a_i=1, b_i=1)$ twice the same as drawing the line $(a_j=2, b_j=2)$ once).</p>
<a id="more"></a>


<h3 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h3><p>In the first line, $n$, $m$ and $p$.</p>
<p>In each of the following $p$ lines, $a_i$ and $b_i$, describing a line.</p>
<h3 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h3><p>An integer, the number of different paintings we could draw mod $10^9+7$.</p>
<h3 id="Sample-IO"><a href="#Sample-IO" class="headerlink" title="Sample IO"></a>Sample IO</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Input:</span><br><span class="line"><span class="number">4</span> <span class="number">2</span> <span class="number">4</span></span><br><span class="line"><span class="number">1</span> <span class="number">1</span></span><br><span class="line"><span class="number">1</span> <span class="number">-1</span></span><br><span class="line"><span class="number">2</span> <span class="number">2</span></span><br><span class="line"><span class="number">2</span> <span class="number">-2</span></span><br><span class="line"></span><br><span class="line">Output:</span><br><span class="line"><span class="number">2</span></span><br></pre></td></tr></table></figure>
<h3 id="Constraints"><a href="#Constraints" class="headerlink" title="Constraints"></a>Constraints</h3><p>$n, m, p \le 100, 1 \le a_i \le 10, -10 \le b_i \le 10$</p>
<h3 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h3><p>Clearly we would need to categorise the lines by their gradient. After which we could use knapsack DP to find all the different lengths a gradient can draw. Let $f_{i, j, k}$ denote the number of different paintings up to $(i, j)$, where the last gradient is $k$, and let $s_{i, j}$ denote the number of different paintints up to $(i, j)$. Then,</p>
<p>$$f_{i, j, k} = \sum s_{i&#39;, j&#39;} - f_{i&#39;, j&#39;, k}$$</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fo(a, b, c) for (int a = b; a &lt;= c; a++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rfo(a, b, c) for (int a = b; a &gt;= c; a--)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> ll MOD = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span>&#123;<span class="keyword">return</span> b ? gcd(b, a%b) : a;&#125;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">vec</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> x, y;</span><br><span class="line">    <span class="keyword">friend</span> <span class="keyword">bool</span> <span class="keyword">operator</span>&lt;(vec a, vec b)&#123;<span class="keyword">return</span> a.x &lt; b.x;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">grad</span>&#123;</span></span><br><span class="line">  <span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">vector</span>&lt;vec&gt; v;</span><br><span class="line">    <span class="keyword">int</span> x, y;</span><br><span class="line">    <span class="keyword">bool</span> book[<span class="number">110</span>];</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(v.empty())</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">int</span> k = gcd(<span class="built_in">abs</span>(v[<span class="number">0</span>].x), <span class="built_in">abs</span>(v[<span class="number">0</span>].y));</span><br><span class="line">        x = v[<span class="number">0</span>].x / k, y = v[<span class="number">0</span>].y / k;</span><br><span class="line"></span><br><span class="line">        sort(v.begin(), v.end());</span><br><span class="line">        book[<span class="number">0</span>] = <span class="literal">true</span>;</span><br><span class="line">        fo(i, <span class="number">0</span>, <span class="number">100</span>)</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">auto</span> j : v)&#123;</span><br><span class="line">                <span class="keyword">if</span>(i - j.x &lt; <span class="number">0</span>)</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">if</span>(book[i - j.x])&#123;</span><br><span class="line">                    book[i] = <span class="literal">true</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;G[<span class="number">110</span>];</span><br><span class="line"></span><br><span class="line"><span class="built_in">map</span>&lt;<span class="keyword">double</span>, <span class="keyword">int</span>&gt; M;</span><br><span class="line">ll cnt, n, m, p, f[<span class="number">110</span>][<span class="number">110</span>][<span class="number">110</span>], s[<span class="number">110</span>][<span class="number">110</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m &gt;&gt; p;</span><br><span class="line">    fo(i, <span class="number">1</span>, p)&#123;</span><br><span class="line">        <span class="keyword">int</span> a, b;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; a &gt;&gt; b;</span><br><span class="line">        <span class="keyword">if</span>(M.count((<span class="keyword">double</span>)a/b))&#123;</span><br><span class="line">            <span class="keyword">int</span> id = M[(<span class="keyword">double</span>)a/b];</span><br><span class="line">            G[id].v.push_back((vec)&#123;a, b&#125;);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            cnt++;</span><br><span class="line">            M.insert(<span class="built_in">pair</span>&lt;<span class="keyword">double</span>, <span class="keyword">int</span>&gt;((<span class="keyword">double</span>)a/b, cnt));</span><br><span class="line">            G[cnt].v.push_back((vec)&#123;a, b&#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    fo(i, <span class="number">1</span>, cnt)</span><br><span class="line">        G[i].init();</span><br><span class="line">    s[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    fo(x, <span class="number">0</span>, n)</span><br><span class="line">        fo(y, <span class="number">0</span>, m)</span><br><span class="line">            fo(k, <span class="number">1</span>, cnt)</span><br><span class="line">                fo(l, <span class="number">1</span>, n - x)</span><br><span class="line">                    <span class="keyword">if</span>(G[k].book[l])&#123;</span><br><span class="line">                        <span class="keyword">int</span> nx = x + l, ny = y + l / G[k].x * G[k].y;</span><br><span class="line">                        <span class="keyword">if</span>(ny &lt; <span class="number">0</span> || ny &gt; m)</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        f[nx][ny][k] = (f[nx][ny][k] + s[x][y] - f[x][y][k] + MOD) % MOD;</span><br><span class="line">                        s[nx][ny] = (s[nx][ny] + s[x][y] - f[x][y][k] + MOD) % MOD;</span><br><span class="line">                    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; s[n][<span class="number">0</span>] &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="DTOJ-1109-UVA-10559-POJ-1390-Blocks"><a href="#DTOJ-1109-UVA-10559-POJ-1390-Blocks" class="headerlink" title="DTOJ 1109, UVA 10559, POJ 1390: Blocks"></a>DTOJ 1109, UVA 10559, POJ 1390: Blocks</h2><p>There exists $n$ coloured blocks in a row, where adjacent blocks of the same colour form a region. Each time, you can remove a region, let the size of that region be $x$, then you gain $x^2$ points. After removing a region, all blocks to its right move left. Find the maximum score.</p>
<h3 id="Input-1"><a href="#Input-1" class="headerlink" title="Input"></a>Input</h3><p>In the first line, $T$, the number of inputs.<br>In the first line of each input, $n$.<br>In the second line of each input, $n$ integers $C_1$ to $C_n$, indicating the colour of the blocks.</p>
<h3 id="Output-1"><a href="#Output-1" class="headerlink" title="Output"></a>Output</h3><p>For each input, output the maximum score in a separate line.</p>
<h3 id="Sample-IO-1"><a href="#Sample-IO-1" class="headerlink" title="Sample IO"></a>Sample IO</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Input:</span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">9</span></span><br><span class="line"><span class="number">1</span> <span class="number">2</span> <span class="number">2</span> <span class="number">2</span> <span class="number">2</span> <span class="number">3</span> <span class="number">3</span> <span class="number">3</span> <span class="number">1</span></span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">1</span></span><br><span class="line"></span><br><span class="line">Output:</span><br><span class="line"><span class="number">29</span></span><br><span class="line"><span class="number">1</span></span><br></pre></td></tr></table></figure>
<h3 id="Constraints-1"><a href="#Constraints-1" class="headerlink" title="Constraints"></a>Constraints</h3><p>$1 \le T \le 15$</p>
<p>$0 \le C_i \le n \le 200$</p>
<h3 id="Solution-1"><a href="#Solution-1" class="headerlink" title="Solution"></a>Solution</h3><p>Let&#39;s first change the input data such that it is in units of regions not blocks, for example, the first sample input would be changed to,</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">4</span>       <span class="comment">// n, the number of regions</span></span><br><span class="line"><span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">1</span> <span class="comment">// a array, indicating the colours of the regions</span></span><br><span class="line"><span class="number">1</span> <span class="number">4</span> <span class="number">3</span> <span class="number">1</span> <span class="comment">// b array, indicating the sizes of the regions</span></span><br></pre></td></tr></table></figure>
<p>Let $f_{i, j, k}$ denote the max. score when $[i:j)$ is removed along with $k$ blocks that have the same colour as region $j$ to the right of $j$. Each time, we could</p>
<ol>
<li>Remove $[i:j-1)$ with nothing to its right, as well as $j$ and the $k$ to its right. (notice that we do not actually know what $k$ is, we are just processing $f$ for each value of $k$)</li>
<li>Remove $j$ with a region, $l$, that has the same colour as $j$ in $[i:j-1)$. $f_{i, j, k} = \max f_{i, l, k+b_j} + f_{l+1, j-1, 0}$. $f_{i, l, k+b_j}$ means removing $l$ with $j$ as well as $k$ blocks to the right of $l$. These $k$ blocks are not within $[l+1, j-1)$ since we do not actually know where the $k$ blocks are and we could just say that they are to the right of $j$ (lol).</li>
</ol>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fo(a, b, c) for (int a = b; a &lt;= c; a++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rfo(a, b, c) for (int a = b; a &gt;= c; a--)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">205</span>;</span><br><span class="line"><span class="keyword">int</span> a[N], b[N], s[N], f[N][N][N];</span><br><span class="line"><span class="keyword">int</span> T, n, now, x, pre;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; T;</span><br><span class="line">    <span class="keyword">while</span>(T--)&#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">        now = x = pre = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">memset</span>(a, <span class="number">0</span>, <span class="keyword">sizeof</span>(a));</span><br><span class="line">        <span class="built_in">memset</span>(b, <span class="number">0</span>, <span class="keyword">sizeof</span>(b));</span><br><span class="line">        <span class="built_in">memset</span>(s, <span class="number">0</span>, <span class="keyword">sizeof</span>(s));</span><br><span class="line">        <span class="built_in">memset</span>(f, <span class="number">0</span>, <span class="keyword">sizeof</span>(f));</span><br><span class="line">        fo(i, <span class="number">1</span>, n)&#123;</span><br><span class="line">            <span class="built_in">cin</span> &gt;&gt; x;</span><br><span class="line">            <span class="keyword">if</span>(x != pre)</span><br><span class="line">                a[++now] = x;</span><br><span class="line">            b[now]++;</span><br><span class="line">            pre = x;</span><br><span class="line">        &#125;</span><br><span class="line">        n = now;</span><br><span class="line">        fo(i, <span class="number">1</span>, n)</span><br><span class="line">            s[i] = s[i<span class="number">-1</span>] + b[i];</span><br><span class="line">        fo(len, <span class="number">0</span>, n<span class="number">-1</span>)</span><br><span class="line">            fo(l, <span class="number">1</span>, n - len)&#123;</span><br><span class="line">                <span class="keyword">int</span> r = l + len;</span><br><span class="line">                fo(k, <span class="number">0</span>, s[n] - s[r])</span><br><span class="line">                    f[l][r][k] = f[l][r<span class="number">-1</span>][<span class="number">0</span>] + (b[r]+k) * (b[r]+k);</span><br><span class="line">                rfo(k, r<span class="number">-1</span>, l)</span><br><span class="line">                    <span class="keyword">if</span>(a[k] == a[r])</span><br><span class="line">                        fo(j, <span class="number">0</span>, s[n] - s[r])</span><br><span class="line">                            f[l][r][j] = max(f[l][r][j], f[l][k][b[r]+j] + f[k+<span class="number">1</span>][r<span class="number">-1</span>][<span class="number">0</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, f[<span class="number">1</span>][n][<span class="number">0</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="DTOJ-1114-Fuzhou"><a href="#DTOJ-1114-Fuzhou" class="headerlink" title="DTOJ 1114: Fuzhou"></a>DTOJ 1114: Fuzhou</h2><p>You are travelling on a directed acyclic graph of $n$ vertices from vertex $1$ to vertex $n$. You can go to any vertex from $1$, and you can go from any vertex to $n$. At a vertex $u$, you examing all edges $e(u, v)$ and randomly pick one of them to go to $v$. Find the expected value of the length of your route from $1$ to $n$.</p>
<h3 id="Input-2"><a href="#Input-2" class="headerlink" title="Input"></a>Input</h3><p>In the firt line, $n$ and $m$, meaning there are $n$ vertices and $m$ edges.</p>
<p>In each of next $m$ lines, $a$, $b$, and $c$, meaning that there is an edge of length $c$ from $a$ to $b$.</p>
<h3 id="Output-2"><a href="#Output-2" class="headerlink" title="Output"></a>Output</h3><p>A decimal of two digit places, the expected value of the length of your route from $1$ to $n$.</p>
<h3 id="Sample-IO-2"><a href="#Sample-IO-2" class="headerlink" title="Sample IO"></a>Sample IO</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Input:</span><br><span class="line"><span class="number">4</span> <span class="number">4</span></span><br><span class="line"><span class="number">1</span> <span class="number">2</span> <span class="number">1</span></span><br><span class="line"><span class="number">1</span> <span class="number">3</span> <span class="number">2</span></span><br><span class="line"><span class="number">2</span> <span class="number">3</span> <span class="number">3</span></span><br><span class="line"><span class="number">3</span> <span class="number">4</span> <span class="number">4</span></span><br><span class="line"></span><br><span class="line">Output:</span><br><span class="line"><span class="number">7.00</span></span><br></pre></td></tr></table></figure>
<h3 id="Constraints-2"><a href="#Constraints-2" class="headerlink" title="Constraints"></a>Constraints</h3><p>$1 \le n \le 10^5, m \le 2n$</p>
<h3 id="Solution-2"><a href="#Solution-2" class="headerlink" title="Solution"></a>Solution</h3><p>We can simply reverse the edges and topologically sort through graph starting at $n$. Let the number of incoming edges to $x$ be represented as $d_x$ and the expected value of the route from $x$ to $n$ be $f_x$, then for all edges $e(u, v)$,</p>
<p>$$ f_v = \frac{\sum f_u  + w(u, v)}{d_v} $$</p>
<p>We can only be certain of $f_u$ once we have processes all edges going to $u$, which is why we need to DP in topological order.</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fo(a, b, c) for (int a = b; a &lt;= c; a++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rfo(a, b, c) for (int a = b; a &gt;= c; a--)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span>+<span class="number">5</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">edge</span>&#123;</span> <span class="keyword">int</span> to, wt; &#125;;</span><br><span class="line"><span class="built_in">vector</span>&lt;edge&gt; G[N];</span><br><span class="line"><span class="keyword">int</span> n, m;</span><br><span class="line"><span class="keyword">int</span> deg[N], temp[N];</span><br><span class="line"><span class="keyword">double</span> f[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">topoSort</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line">    q.push(n);</span><br><span class="line">    <span class="keyword">while</span>(!q.empty())&#123;</span><br><span class="line">        <span class="keyword">int</span> u = q.front();</span><br><span class="line">        q.pop();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> e : G[u])&#123;</span><br><span class="line">            <span class="keyword">int</span> v = e.to;</span><br><span class="line">            temp[v]--;</span><br><span class="line">            f[v] += (f[u] + e.wt) / deg[v];</span><br><span class="line">            <span class="keyword">if</span>(temp[v] == <span class="number">0</span>)</span><br><span class="line">                q.push(v);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    fo(i, <span class="number">1</span>, m)&#123;</span><br><span class="line">        <span class="keyword">int</span> u, v, w;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d&quot;</span>, &amp;u, &amp;v, &amp;w);</span><br><span class="line">        G[v].push_back( (edge)&#123;u, w&#125; );</span><br><span class="line">        deg[u]++;</span><br><span class="line">    &#125;</span><br><span class="line">    fo(i, <span class="number">1</span>, n)</span><br><span class="line">        temp[i] = deg[i];</span><br><span class="line">    topoSort();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%.2f&quot;</span>, f[<span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="DTOJ-1606-USACO-2012-Nov-Gold-Balanced-Cow-Breeds"><a href="#DTOJ-1606-USACO-2012-Nov-Gold-Balanced-Cow-Breeds" class="headerlink" title="DTOJ 1606, USACO 2012 Nov. Gold: Balanced Cow Breeds"></a>DTOJ 1606, USACO 2012 Nov. Gold: Balanced Cow Breeds</h2><p><a target="_blank" rel="noopener" href="http://www.usaco.org/index.php?page=viewproblem2&cpid=193">Problem Link</a></p>
<p><a target="_blank" rel="noopener" href="http://www.usaco.org/current/data/sol_bbreeds.html">Solution</a></p>
<p>Lesson: in DP parts of the status can be derived from other parts of the status, in which case we would not need to iterate them as part of the DP.</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fo(a, b, c) for (int a = b; a &lt;= c; a++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rfo(a, b, c) for (int a = b; a &gt;= c; a--)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e3</span>+<span class="number">5</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MOD = <span class="number">2012</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> s[N];</span><br><span class="line"><span class="keyword">int</span> n, cnt, f[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, s+<span class="number">1</span>);</span><br><span class="line">    n = <span class="built_in">strlen</span>(s+<span class="number">1</span>);</span><br><span class="line">    cnt = f[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    fo(i, <span class="number">1</span>, n)&#123;</span><br><span class="line">        <span class="keyword">if</span>(cnt &lt;= <span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">int</span> dir = s[i] == <span class="string">&#x27;(&#x27;</span> ? <span class="number">1</span> : <span class="number">-1</span>;</span><br><span class="line">        cnt += dir;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = dir &lt; <span class="number">0</span> ? <span class="number">1</span> : cnt; <span class="number">1</span> &lt;= j &amp;&amp; j &lt;= cnt; j -= dir)</span><br><span class="line">            f[j] = (f[j] + f[j - dir]) % MOD;</span><br><span class="line">        f[cnt+<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, cnt == <span class="number">1</span> ? f[<span class="number">1</span>] : <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="DTOJ-1608-Fight"><a href="#DTOJ-1608-Fight" class="headerlink" title="DTOJ 1608: Fight"></a>DTOJ 1608: Fight</h2><p>Given an undirected connected graph representing cities and roads, you are to send troops to patrol the graph such that there exists, at all times, a path from any city to any other city on which every edge is patrolled. Each edge requires a number of soldiers to patrol, and each soldier requires $v$ food per day.</p>
<p>It is war time, and you enemies may attack the roads via missiles. Your intelligence department has informed you when the enemies will attack your roads with missiles and how many missiles will they send (you trust your intelligence department). That is, for the $i$-th one of the $p$ missles, you know $u_i$, $v_i$, $l_i$ and $r_i$ such that the edge connected $u_i$ and $v_i$ will be unavailable starting day $l_i$, and it will take you until day $r_i+1$ to repair it.</p>
<p>You may change your patrolling plan at all times with a cost of $k$ food to move soldiers around. Find the minimum number of food required.</p>
<h3 id="Input-3"><a href="#Input-3" class="headerlink" title="Input"></a>Input</h3><p>In the first line, $n$, $m$, $t$, $v$, $k$, representing respectively, the number of cities, the number of roads, the number of days, the food required per soldier per day and the food required to change patrolling plan.</p>
<p>In each of the next $m$ lines, $u$, $v$ and $w$, representing an edge between $u$ and $v$ requiring $w$ soldiers to patrol.</p>
<p>In the next line, $p$, the number of missiles.</p>
<p>In the next $p$ lines, $u$, $v$, $l$ and $r$, as per the problem description.</p>
<h3 id="Output-3"><a href="#Output-3" class="headerlink" title="Output"></a>Output</h3><p>The minimum number of food.</p>
<h3 id="Sample-IO-3"><a href="#Sample-IO-3" class="headerlink" title="Sample IO"></a>Sample IO</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Input:</span><br><span class="line"><span class="number">3</span> <span class="number">3</span> <span class="number">5</span> <span class="number">10</span> <span class="number">30</span></span><br><span class="line"><span class="number">1</span> <span class="number">2</span> <span class="number">1</span></span><br><span class="line"><span class="number">2</span> <span class="number">3</span> <span class="number">2</span></span><br><span class="line"><span class="number">1</span> <span class="number">3</span> <span class="number">4</span></span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">1</span> <span class="number">3</span> <span class="number">2</span> <span class="number">5</span></span><br><span class="line"></span><br><span class="line">Output:</span><br><span class="line"><span class="number">180</span></span><br></pre></td></tr></table></figure>
<h3 id="Constraints-3"><a href="#Constraints-3" class="headerlink" title="Constraints"></a>Constraints</h3><p>$n \le 300$, $m \le 5000$, $t \le 50$, $v \le 20$, $p \le 10000$, $w \le 300$</p>
<h3 id="Solution-3"><a href="#Solution-3" class="headerlink" title="Solution"></a>Solution</h3><p>We can use kruskal to find the minimum spanning tree for day $l$ to $r$ without changing patrolling plans, then use knapsack DP to find the answer.</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fo(a, b, c) for (int a = b; a &lt;= c; a++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rfo(a, b, c) for (int a = b; a &gt;= c; a--)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">305</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">5005</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x7f7f7f7f</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UnionFindSet</span>&#123;</span></span><br><span class="line">  <span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">int</span> f[N];</span><br><span class="line">  <span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123; fo(i, <span class="number">0</span>, N<span class="number">-1</span>) f[i] = i; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">getf</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123; <span class="keyword">return</span> f[x] == x ? x : f[x] = getf(f[x]); &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">merge</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123; f[getf(x)] = f[getf(y)]; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">same</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123; <span class="keyword">return</span> getf(x) == getf(y); &#125;</span><br><span class="line">&#125;S;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">edge</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> u, v, w;</span><br><span class="line">    <span class="keyword">friend</span> <span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (edge a, edge b)&#123; <span class="keyword">return</span> a.w &lt; b.w; &#125;</span><br><span class="line">&#125;e[M];</span><br><span class="line"><span class="keyword">bool</span> book[<span class="number">55</span>][N][N];</span><br><span class="line"><span class="keyword">int</span> n, m, t, v, k, p;</span><br><span class="line"><span class="keyword">int</span> d[<span class="number">55</span>][<span class="number">55</span>], f[<span class="number">55</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">ok</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    fo(i, l, r)</span><br><span class="line">        <span class="keyword">if</span>(book[i][u][v])</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">kruskal</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    S.init();</span><br><span class="line">    <span class="keyword">int</span> Min = <span class="number">0</span>, cnt = n;</span><br><span class="line">    fo(i, <span class="number">1</span>, m)</span><br><span class="line">        <span class="keyword">if</span>(!S.same(e[i].u, e[i].v) &amp;&amp; ok(e[i].u, e[i].v, l, r))&#123;</span><br><span class="line">            S.merge(e[i].u, e[i].v);</span><br><span class="line">            Min += e[i].w;</span><br><span class="line">            cnt--;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">return</span> cnt == <span class="number">1</span> ? Min * v : INF;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d%d%d&quot;</span>, &amp;n, &amp;m, &amp;t, &amp;v, &amp;k);</span><br><span class="line">    fo(i, <span class="number">1</span>, m)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;e[i].u, &amp;e[i].v, &amp;e[i].w);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;p);</span><br><span class="line">    fo(i, <span class="number">1</span>, p)&#123;</span><br><span class="line">        <span class="keyword">int</span> x, y, t1, t2;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d%d&quot;</span>, &amp;x, &amp;y, &amp;t1, &amp;t2);</span><br><span class="line">        <span class="keyword">if</span>(t1 &gt; t2)</span><br><span class="line">            swap(t1, t2);</span><br><span class="line">        fo(j, t1, t2)</span><br><span class="line">            book[j][x][y] = book[j][y][x] = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    sort(e+<span class="number">1</span>, e+m+<span class="number">1</span>);</span><br><span class="line">    fo(i, <span class="number">1</span>, t)</span><br><span class="line">        fo(j, i, t)</span><br><span class="line">            d[i][j] = kruskal(i, j);</span><br><span class="line">    fo(i, <span class="number">1</span>, t)&#123;</span><br><span class="line">        f[i] = k + d[<span class="number">1</span>][i] * i;</span><br><span class="line">        fo(j, <span class="number">1</span>, i<span class="number">-1</span>)</span><br><span class="line">            <span class="keyword">if</span>(d[j+<span class="number">1</span>][i] != INF)</span><br><span class="line">                f[i] = min(f[i], f[j] + d[j+<span class="number">1</span>][i] * (i - j) + k);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, f[t]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

    </div>

    
    
    
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>Post author:  </strong>thyroidr
  </li>
  <li class="post-copyright-link">
    <strong>Post link: </strong>
    <a href="https://thyroidr.github.io/InfoBlogs/uncategorized/DP/dp-practice/" title="DP Practice">https://thyroidr.github.io/InfoBlogs/uncategorized/DP/dp-practice/</a>
  </li>
  <li class="post-copyright-license">
    <strong>Copyright Notice:  </strong>All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> unless stating additionally.
  </li>
</ul>
</div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/InfoBlogs/tags/dp/" rel="tag"># dp</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/InfoBlogs/Number-Theory-and-Mathematics/Number%20Theory%20and%20Mathematics/bit-wise-operations/" rel="prev" title="Bitwise Operations">
      <i class="fa fa-chevron-left"></i> Bitwise Operations
    </a></div>
      <div class="post-nav-item">
    <a href="/InfoBlogs/Number-Theory-and-Mathematics/Number%20Theory%20and%20Mathematics/combinatorics%20tricks/" rel="next" title="Combinatorics Tricks">
      Combinatorics Tricks <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#DTOJ-1103-Paint"><span class="nav-number">1.</span> <span class="nav-text">DTOJ 1103: Paint</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Input"><span class="nav-number">1.1.</span> <span class="nav-text">Input</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Output"><span class="nav-number">1.2.</span> <span class="nav-text">Output</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Sample-IO"><span class="nav-number">1.3.</span> <span class="nav-text">Sample IO</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Constraints"><span class="nav-number">1.4.</span> <span class="nav-text">Constraints</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Solution"><span class="nav-number">1.5.</span> <span class="nav-text">Solution</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#DTOJ-1109-UVA-10559-POJ-1390-Blocks"><span class="nav-number">2.</span> <span class="nav-text">DTOJ 1109, UVA 10559, POJ 1390: Blocks</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Input-1"><span class="nav-number">2.1.</span> <span class="nav-text">Input</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Output-1"><span class="nav-number">2.2.</span> <span class="nav-text">Output</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Sample-IO-1"><span class="nav-number">2.3.</span> <span class="nav-text">Sample IO</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Constraints-1"><span class="nav-number">2.4.</span> <span class="nav-text">Constraints</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Solution-1"><span class="nav-number">2.5.</span> <span class="nav-text">Solution</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#DTOJ-1114-Fuzhou"><span class="nav-number">3.</span> <span class="nav-text">DTOJ 1114: Fuzhou</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Input-2"><span class="nav-number">3.1.</span> <span class="nav-text">Input</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Output-2"><span class="nav-number">3.2.</span> <span class="nav-text">Output</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Sample-IO-2"><span class="nav-number">3.3.</span> <span class="nav-text">Sample IO</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Constraints-2"><span class="nav-number">3.4.</span> <span class="nav-text">Constraints</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Solution-2"><span class="nav-number">3.5.</span> <span class="nav-text">Solution</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#DTOJ-1606-USACO-2012-Nov-Gold-Balanced-Cow-Breeds"><span class="nav-number">4.</span> <span class="nav-text">DTOJ 1606, USACO 2012 Nov. Gold: Balanced Cow Breeds</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#DTOJ-1608-Fight"><span class="nav-number">5.</span> <span class="nav-text">DTOJ 1608: Fight</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Input-3"><span class="nav-number">5.1.</span> <span class="nav-text">Input</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Output-3"><span class="nav-number">5.2.</span> <span class="nav-text">Output</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Sample-IO-3"><span class="nav-number">5.3.</span> <span class="nav-text">Sample IO</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Constraints-3"><span class="nav-number">5.4.</span> <span class="nav-text">Constraints</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Solution-3"><span class="nav-number">5.5.</span> <span class="nav-text">Solution</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Ryan Wang"
      src="/InfoBlogs/images/avatar.png">
  <p class="site-author-name" itemprop="name">Ryan Wang</p>
  <div class="site-description" itemprop="description">Museum of my involvement in Informatics Olympiads & competitive programming</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/InfoBlogs/archives/">
        
          <span class="site-state-item-count">74</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/InfoBlogs/categories/">
          
        <span class="site-state-item-count">14</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/InfoBlogs/tags/">
          
        <span class="site-state-item-count">53</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/thyroidr" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;thyroidr" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:ryanxiaowang2001@gmail.com" title="E-Mail → mailto:ryanxiaowang2001@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.linkedin.com/in/rxw/" title="LinkedIn → https:&#x2F;&#x2F;www.linkedin.com&#x2F;in&#x2F;rxw&#x2F;" rel="noopener" target="_blank"><i class="fab fa-linkedin fa-fw"></i>LinkedIn</a>
      </span>
  </div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/InfoBlogs/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2018 – 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Ryan Wang</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://mist.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/InfoBlogs/lib/anime.min.js"></script>
  <script src="/InfoBlogs/lib/velocity/velocity.min.js"></script>
  <script src="/InfoBlogs/lib/velocity/velocity.ui.min.js"></script>

<script src="/InfoBlogs/js/utils.js"></script>

<script src="/InfoBlogs/js/motion.js"></script>


<script src="/InfoBlogs/js/schemes/muse.js"></script>


<script src="/InfoBlogs/js/next-boot.js"></script>




  















  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  

</body>
</html>
